(function(t,r){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=r(require("d3"),require("./widget"),exports)}else if(typeof define==="function"&&define.amd){define(["d3","src/widget","exports"],r)}else{t.du=t.du||{};t.du.widgets=t.du.widgets||{};t.du.widgets.TrackPad=r(t.d3,t.du.Widget)}})(this,function(t,r){"use strict";function a(a,e){var i=r.call(this,a,"slider","svg",e);i.attr.add(this,"xRange",[0,1]);i.attr.add(this,"yRange",[0,1]);i.attr.add(this,"callback",null);i.attr.add(this,"guide",false);var n={};var s=null;i.render.build=function(){s={x:t.scaleLinear().domain(i.attr.xRange).range([0,i.attr.width-i.attr.margins.left-i.attr.margins.right]).clamp(true),y:t.scaleLinear().domain(i.attr.yRange).range([0,i.attr.height-i.attr.margins.top-i.attr.margins.bottom]).clamp(true)};n.g=i.widget.append("g").attr("transform","translate("+i.attr.margins.left+",20)");n.track=n.g.append("rect").attr("rx","3").attr("ry","3").attr("x",s.x.range()[0]).attr("y",s.y.range()[0]).attr("width",i.attr.width-i.attr.margins.left-i.attr.margins.right+"px").attr("height",i.attr.height-i.attr.margins.top-i.attr.margins.bottom+"px");n.inset=n.track.select(function(){return this.parentNode.appendChild(this.cloneNode(true))}).style("fill","white").style("opacity",.9).attr("rx","2.5").attr("ry","2.5").attr("x",s.x.range()[0]+.5).attr("y",s.y.range()[0]+.5).attr("width",i.attr.width-i.attr.margins.left-i.attr.margins.right-1+"px").attr("height",i.attr.height-i.attr.margins.top-i.attr.margins.bottom-1+"px");if(i.attr.guide){n.guide={h:n.g.append("line").attr("x1",s.x.range()[0]).attr("y1",s.y.range()[0]).attr("x2",s.x.range()[1]).attr("y2",s.y.range()[0]).attr("stroke-dasharray","3, 6").style("stroke",i.attr.fontColor).style("stroke-width","1px"),v:n.g.append("line").attr("x1",s.x.range()[0]).attr("y1",s.y.range()[0]).attr("x2",s.x.range()[0]).attr("y2",s.y.range()[1]).attr("stroke-dasharray","3, 6").style("stroke-width","1px")}}n.overlay=n.inset.select(function(){return this.parentNode.appendChild(this.cloneNode(true))}).attr("class","track-overlay").style("pointer-events","all").style("cursor","pointer").style("fill","transparent").call(t.drag().on("start drag",function(){var r=s.x.invert(t.event.x),a=s.y.invert(t.event.y);n.handle.attr("cx",s.x(r)).attr("cy",s.y(a));if(n.guide){n.guide.h.attr("x1",s.x.range()[0]).attr("y1",s.y(a)).attr("x2",s.x.range()[1]).attr("y2",s.y(a));n.guide.v.attr("x1",s.x(r)).attr("y1",s.y.range()[0]).attr("x2",s.x(r)).attr("y2",s.y.range()[1])}i.attr.callback&&i.attr.callback(r,a)}));n.axis={x:n.g.append("g").attr("class","x axis").style("font-family","inherit").style("fill","none"),y:n.g.append("g").attr("class","x axis").style("font-family","inherit").style("fill","none")};n.handle=n.g.insert("circle",".track-overlay").style("fill","white").style("stroke-width","0.5px").attr("r",7)};i.render.style=function(){i.widget.style("width",i.attr.width+"px");i.widget.style("height",i.attr.height+"px");s.x.range([0,i.attr.width-i.attr.margins.left-i.attr.margins.right]);s.y.range([0,i.attr.height-i.attr.margins.top-i.attr.margins.bottom]);n.track.style("fill",i.attr.fontColor).attr("x",s.x.range()[0]).attr("y",s.y.range()[0]).attr("width",i.attr.width-i.attr.margins.left-i.attr.margins.right+"px").attr("height",i.attr.height-i.attr.margins.top-i.attr.margins.bottom+"px");n.inset.attr("x",s.x.range()[0]+.5).attr("y",s.y.range()[0]+.5).attr("width",i.attr.width-i.attr.margins.left-i.attr.margins.right-1+"px").attr("height",i.attr.height-i.attr.margins.top-i.attr.margins.bottom-1+"px");if(i.attr.guide){n.guide.h.style("stroke",i.attr.fontColor);n.guide.v.style("stroke",i.attr.fontColor)}n.overlay.attr("x",s.x.range()[0]-i.attr.margins.left+10).attr("y",s.y.range()[0]-i.attr.margins.top+10).attr("width",i.attr.width-20+"px").attr("height",i.attr.height-20+"px");n.axis.x.attr("transform","translate(-1,"+(i.attr.height-i.attr.margins.bottom-30)+")").call(t.axisBottom().ticks(5).scale(s.x));n.axis.y.call(t.axisLeft().ticks(5).scale(s.y));n.g.selectAll("path").style("fill","none").style("stroke","none");n.g.selectAll(".tick > line").style("fill","none").style("stroke","none");n.g.selectAll("text").attr("font-size",i.attr.fontSize+"px").attr("fill",i.attr.fontColor);n.handle.style("stroke",i.attr.fontColor)}}a.prototype=Object.create(r.prototype);return a});