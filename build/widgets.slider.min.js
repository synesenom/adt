(function(t,r){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=r(require("d3"),require("./widget"),exports)}else if(typeof define==="function"&&define.amd){define(["d3","src/widget","exports"],r)}else{t.du=t.du||{};t.du.widgets=t.du.widgets||{};t.du.widgets.Slider=r(t.d3,t.du.Widget)}})(this,function(c,f){"use strict";function t(t,r){var e=f.call(this,t,"slider","svg",r);e.attr.add(this,"min",0);e.attr.add(this,"max",1);e.attr.add(this,"step",0);e.attr.add(this,"callback",null);e.attr.add(this,"track",false);e.attr.add(this,"fillColor","black");e.attr.add(this,"thickness",8);e.attr.add(this,"trackColor","#ddd");e.attr.add(this,"format",null);var i={};var a={right:20,left:20};var n=false;var l=[];var s=null;var o=null;function d(t){i.handle.attr("cx",s(t));i.valueTrack.attr("x2",s(t))}this.position=function(t){o=t;return this};e.render.build=function(){l=[e.attr.min,e.attr.max];s=c.scaleLinear().domain(l).range([0,e.attr.width-e.attr.margins.left-e.attr.margins.right]).clamp(true);if(e.attr.step){n=true;l=[];for(var t=e.attr.min;t<=e.attr.max;t+=e.attr.step){l.push(t)}s=c.scalePoint().domain(l).range([0,e.attr.width-e.attr.margins.left-e.attr.margins.right])}i.g=e.widget.append("g").attr("transform","translate("+e.attr.margins.left+",20)");i.track=i.g.append("line").attr("stroke-linecap","round").attr("stroke",e.attr.trackColor).attr("stroke-width",e.attr.thickness+"px").attr("x1",s.range()[0]).attr("x2",s.range()[1]);i.overlay=i.track.select(function(){return this.parentNode.appendChild(this.cloneNode(true))}).attr("class","track-overlay").style("pointer-events","stroke").style("cursor","pointer").style("stroke","transparent").style("stroke-width","50px").call(c.drag().on("start drag",function(){i.handle.style("fill",e.attr.fillColor).style("stroke-width","2px").style("stroke","white");var t=null;if(n){var a=c.event.x;t=l.reduce(function(t,r){return Math.abs(s(r)-a)<Math.abs(s(t)-a)?r:t})}else{t=s.invert(c.event.x)}i.handle.attr("cx",s(t));i.valueTrack.attr("x2",s(t));e.attr.callback&&e.attr.callback(t)}).on("end",function(){i.handle.style("fill","white").style("stroke-width","1px").style("stroke",e.attr.trackColor)}));i.axis=i.g.insert("g",".track-overlay").attr("font-family","inherit").attr("transform","translate(0,"+20+")").style("font-size","10px");i.ticks=i.axis.selectAll("text").data(n?l:s.ticks(5)).enter().append("text").attr("x",s).attr("text-anchor","middle").attr("font-family","inherit").text(function(t){return e.attr.format===null?t:e.attr.format(t)});i.valueTrack=i.g.insert("line",".track-overlay").attr("x1",s.range()[0]).attr("x2",s.range()[0]).attr("stroke-linecap","round").style("stroke-width",e.attr.thickness+"px").style("stroke",e.attr.fillColor);i.handle=i.g.insert("circle",".track-overlay").attr("r",e.attr.thickness).style("fill","white").style("stroke-width","1px").style("stroke",e.attr.trackColor)};e.render.update=function(){if(o!==null){d(o);o=null}};e.render.style=function(){e.widget.style("width",e.attr.width+"px");e.widget.style("height",50+"px");s.range([0,e.attr.width-e.attr.margins.left-e.attr.margins.right]);i.track.attr("x1",s.range()[0]).attr("x2",s.range()[1]);i.overlay.attr("x1",s.range()[0]).attr("x2",s.range()[1]);i.ticks.attr("x",s).attr("font-size",e.attr.fontSize+"px").attr("fill",e.attr.fontColor)}}t.prototype=Object.create(f.prototype);return t});