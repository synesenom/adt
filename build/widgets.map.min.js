(function(t,e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e(require("d3"),require("lodash"),require("topojson"),require("leaflet"),require("./math.la"),require("./widget"))}else if(typeof define==="function"&&define.amd){define(["d3","_","topojson","leaflet","src/math.la","src/widget","exports"],e)}else{t.du=t.du||{};t.du.widgets=t.du.widgets||{};t.du.widgets.Map=e(t.d3,t._,t.topojson,t.L,t.du.math.la,t.du.Widget)}})(this,function(E,h,c,s,P,n){"use strict";function t(t,e){var w="du-widgets-map";var M=n.call(this,t,"map","div",e);var b=this;M.attr.add(this,"resource",null);M.attr.add(this,"centerX",0);M.attr.add(this,"centerY",0);M.attr.add(this,"backgroundColor","white");M.attr.add(this,"foregroundColor","black");M.attr.add(this,"borderColor","white");M.attr.add(this,"outClick",null);M.attr.add(this,"tiles",null);M.attr.add(this,"noZoom",false);M.attr.add(this,"ready",null);var m=function(){var n=null;var a=null;var o=E.map();function t(e){E.json(M.attr.resource,function(t,r){n=c.feature(r.paths,r.paths["objects"]["countries"]).features;n.filter(function(e){return r.info.some(function(t){if(e.id===t.id)return e.name=t.name})}).sort(function(t,e){return t.name.localeCompare(e.name)});a=E.map();r.info.forEach(function(t){a.set(t.name,{name:t.name,capital:t.capital,population:t.population})});n.forEach(function(t,e){o.set(t.name,e)});e&&e()})}function e(t){return o.has(t)?o.get(t):null}function r(){return n.map(function(t){return{id:t.id,name:t.name}})}function i(t){return t&&a.has(t)?a.get(t).capital:a.values().map(function(t){return{name:t.name,capital:t.capital}})}function s(t){return t&&a.has(t)?a.get(t).population:a.values().map(function(t){return{name:t.name,population:t.population}})}function l(t,e){var r,n,a,o,i,s=t[0],l=t[1],u=false;for(var c=0,f=e.length-1;c<e.length;f=c++){r=e[c][0];a=e[c][1];n=e[f][0];o=e[f][1];i=a>l!==o>l&&s<(n-r)*(l-a)/(o-a)+r;if(i)u=!u}return u}function u(t,e){var r=m._id(t);if(r){var n=j._project(e);var a=m._paths()[r].svg.areas;for(var o=0;o<a.length;o++){if(l(n,a[o])){return true}}}return false}return{_paths:function(){return n},_id:e,_build:t,get:r,capital:i,population:s,containsGeoLoc:u}}();this.countries={get:m.get,capital:m.capital,population:m.population,containsGeoLoc:m.containsGeoLoc};var r=function(){var r={};function a(t,e){return M.utils.encode(t)+"__"+M.utils.encode(e)}function t(t){if(t&&r.hasOwnProperty(t)){return Object.keys(r[t])}else{return Object.keys(r)}}function e(t,e){if(!r.hasOwnProperty(t)){r[t]=e;return true}else{return false}}function n(n){if(r.hasOwnProperty(n)){h.forOwn(r[n],function(t,e){var r=a(n,e);t.forEach(function(t){if(typeof m._id(t)==="number"){j._select(t).classed(r,false)}})});return true}else{return false}}function o(){h.forOwn(r,function(t,n){h.forOwn(t,function(t,e){var r=a(n,e);t.forEach(function(t){if(typeof m._id(t)==="number"){j._select(t).classed(r,true)}})})})}return{get:t,add:e,remove:n,selector:a,_mark:o}}();this.clustering={get:r.get,add:r.add,remove:r.remove,selector:r.selector};var L=function(){var s=4096;var t=.3;var l={};var e=E.zoomIdentity;var r=1;var u=E.zoom().scaleExtent([1,s]).on("zoom",f);function n(t){return e.apply(t)}function a(t){return e.invert(t)}function o(){return r}function i(){u.translateExtent([[-t*M.attr.width,-t*M.attr.height],[(1+t)*M.attr.width,(1+t)*M.attr.height]])}function c(t,e){l[t]=e}function f(){if(M.attr.noZoom){return}var t=E.event.transform.k;l.map.paths.style("stroke-width",.5/t+"px");l.map.paths.attr("transform",E.event.transform);y._zoom(E.event.transform);v._zoom(E.event.transform);g._zoom(E.event.transform);x._zoom(E.event.transform);if(E.event&&E.event.transform){e=E.zoomIdentity.translate(E.event.transform.x,E.event.transform.y).scale(E.event.transform.k);r=E.event.transform.k}}function h(){l.map.svg.transition().duration(1e3).call(u.transform,E.zoomIdentity)}function d(t){var e=t[1][0]-t[0][0],r=t[1][1]-t[0][1],n=(t[0][0]+t[1][0])/2,a=(t[0][1]+t[1][1])/2,o=Math.max(1,Math.min(s,.8/Math.max(e/M.attr.width,r/M.attr.height))),i=[M.attr.width/2-o*n,M.attr.height/2-o*a];l.map.svg.transition().duration(1e3).call(u.transform,E.zoomIdentity.translate(i[0],i[1]).scale(o))}function p(){return e}return{init:i,setLayer:c,zoom:u,reset:h,click:d,transform:n,invert:a,level:o,current:p}}();var j=function(){var t=M.widget.append("svg").attr("id",w+"-map-layer").style("position","absolute").call(L.zoom);var e=t.append("rect").attr("id","water").style("position","absolute").style("width","100%").style("height","100%").style("fill","transparent").style("top",0).style("left",0);var r=t.append("g").attr("id","land");var o=null;var i=E.geoMercator().precision(.1);var s=E.geoPath().projection(i);var n=null;function a(t){return i([t[1],t[0]])}function l(t){return i.invert(t).reverse()}function u(){m._paths().forEach(function(t){t.svg.center=s.centroid(t)})}function c(){m._paths().forEach(function(r){var n=[];var a=[];var t=r.geometry.coordinates;if(t.length===1){t[0].forEach(function(t){var e=i(t);n.push(Math.abs(e[0]-r.svg.center[0]));a.push(Math.abs(e[1]-r.svg.center[1]))})}else{t.forEach(function(t){t[0].forEach(function(t){var e=i(t);n.push(Math.abs(e[0]-r.svg.center[0]));a.push(Math.abs(e[1]-r.svg.center[1]))});if(t.length>1){t.forEach(function(t){var e=i(t);n.push(Math.abs(e[0]-r.svg.center[0]));a.push(Math.abs(e[1]-r.svg.center[1]))})}})}r.svg.width=E.max(n)*2;r.svg.height=E.max(a)*2})}function f(){m._paths().forEach(function(r){r.svg.areas=null;if(r.geometry.coordinates.length===1){var e=[];r.geometry.coordinates[0].forEach(function(t){e.push(i(t))});r.svg.areas=[e]}else{r.svg.areas=[];r.geometry.coordinates.forEach(function(t){var e=[];if(t.length>1){t.forEach(function(t){e.push(i(t))})}else{t[0].forEach(function(t){e.push(i(t))})}r.svg.areas.push(e)})}})}function h(){o=r.selectAll("path").data(m._paths()).enter().append("path").attr("class",function(t){return"country-"+m._id(t.name)}).style("stroke-width","0.5px").style("cursor","pointer");d();p()}function d(){if(o===null){return}i.scale(M.attr.width/(2*Math.PI)).translate([M.attr.width/2+M.attr.centerX,M.attr.height/2+M.attr.centerY]);s=E.geoPath().projection(i);m._paths().forEach(function(t){t.svg={}});u();c();f()}function p(){if(o===null){return}t.attr("width",M.attr.width+"px").attr("height",M.attr.height+"px");e.style("fill",M.attr.backgroundColor).style("width",M.attr.width+"px").style("height",M.attr.height+"px").on("click",function(){L.reset();o.classed("focus",false).style("fill",function(t){return M.attr.colors&&M.attr.colors[t.name]?M.attr.colors[t.name]:M.attr.foregroundColor});if(M.attr.outClick)M.attr.outClick()});o.attr("d",s).style("fill",function(t){return M.attr.colors&&M.attr.colors[t.name]?M.attr.colors[t.name]:M.attr.foregroundColor}).style("stroke",M.attr.borderColor).style("cursor","pointer").on("mouseover",function(t,e){E.select(this).style("fill",E.color(M.attr.colors&&M.attr.colors[t.name]?M.attr.colors[t.name]:M.attr.foregroundColor).brighter());M.attr.mouseover&&M.attr.mouseover(t.name)}).on("mouseleave",function(t,e){var r=E.select(this);var n=E.color(M.attr.colors&&M.attr.colors[t.name]?M.attr.colors[t.name]:M.attr.foregroundColor);r.style("fill",r.classed("focus")?n.brighter():n);M.attr.mouseleave&&M.attr.mouseleave(t.name)}).on("click",function(e,t){var r=E.select(this);var n=r.classed("focus");if(n)L.reset();else{L.click(s.bounds(e))}o.classed("focus",function(t){return t===e?!n:false}).style("fill",function(t){return M.attr.colors&&M.attr.colors[t.name]?M.attr.colors[t.name]:M.attr.foregroundColor});var a=E.color(M.attr.colors&&M.attr.colors[e.name]?M.attr.colors[e.name]:M.attr.foregroundColor);r.style("fill",!n?a.brighter():a);M.attr.click&&M.attr.click(e.name)});L.setLayer("map",{svg:t,paths:o,labels:n})}function v(t){if(typeof t==="string"){return m._id(t)?r.select("path.country-"+m._id(t)):r.selectAll("path."+M.utils.encode(t))}else{return o}}function y(t){o.style("opacity",t?t:1);return b}function g(r,n,t){v(r).transition().duration(t?t:0).style("fill",function(t){var e=M.attr.colors&&M.attr.colors[t.name]?M.attr.colors[t.name]:M.attr.foregroundColor;return typeof n==="string"?n:typeof r==="string"?E.color(e).brighter():e});return b}return{_select:v,_project:a,_invert:l,_build:h,_update:d,_style:p,dim:y,highlight:g}}();this.dim=j.dim;this.highlight=j.highlight;var v=function(){var l=M.widget.append("div").attr("id",w+"-static-layers").style("position","absolute").style("pointer-events","none").style("z-index",9).style("width",M.attr.width+"px").style("height",M.attr.height+"px");var m={};function u(t,e,r){return[e[0]*t[0]+r[0],e[1]*t[1]+r[1]]}function t(){return Object.keys(m)}function e(t){var s=M.utils.encode(t);if(!m.hasOwnProperty(s)){m[s]=function(){var t=l.append("canvas").attr("id",w+"-static-layer-"+s).attr("width",M.attr.width+"px").attr("height",M.attr.height+"px").style("position","absolute").style("pointer-events","none");var p=t.node().getContext("2d");var a=[];function e(t,e){o[t](e);a.push({type:t,params:e});return true}function r(t,e){var r=[1/t,1/t],n=[M.attr.centerX*(t-1)/t,(M.attr.height*(t-e)/2+M.attr.centerY*(t-1))/t];a.forEach(function(t){switch(t.type){case"dot":case"circle":t.params.pos=u(t.params.pos,r,n);break;case"arrow":for(var e=0;e<t.params.segments.length;e++){t.params.segments[e]=new P.Vector2(u(t.params.segments[e].toArray(),r,n))}break}})}function n(){a=[]}var o={dot:function(t,e){if(t.color)p.fillStyle=t.color;var r=t.size/(e?L.level():1);var n=!e?L.transform(t.pos):t.pos;p.fillRect(n[0]-r/2,n[1]-r/2,r,r)},circle:function(t,e){if(t.color)p.fillStyle=t.color;var r=t.radius/(e?L.level():1);var n=!e?L.transform(t.pos):t.pos;p.beginPath();p.arc(n[0],n[1],r,0,2*Math.PI,false);p.fill()},arrow:function(t,e){if(t.color)p.strokeStyle=t.color;var r=t.width/(e?L.level():1);var n=[];t.segments.forEach(function(t){n.push(!e?t.map(L.transform):t)});var a=r*2;var o=r*5;var i=n[n.length-2];var s=n[n.length-1];var l=s.sub(i).length(o);p.beginPath();p.lineWidth=r;p.lineJoin="round";p.moveTo(n[0].x(),n[0].y());for(var u=1;u<n.length-1;u++){if(n[u].sub(n[u-1]).length()<.6*M.attr.width)p.lineTo(n[u].x(),n[u].y());else p.moveTo(n[u].x(),n[u].y())}var c=s.sub(l.length(.5*o));p.lineTo(c.x(),c.y());p.stroke();var f=l.angle(l.angle()+Math.PI/2).length(a);var h=s.sub(l).sub(f);var d=s.sub(l).add(f);p.beginPath();p.moveTo(h.x(),h.y());p.lineTo(d.x(),d.y());p.lineTo(s.x(),s.y());p.closePath();p.fillStyle=t.color;p.fill()}};function i(){var t=L.invert([0,0]);var e=L.invert([M.attr.width,M.attr.height]);var r={xMin:t[0],xMax:e[0],yMin:t[1],yMax:e[1]};a.forEach(function(t){if(t.params.pos&&(t.params.pos[0]<r.xMin||t.params.pos[0]>r.xMax||t.params.pos[1]<r.yMin||t.params.pos[1]>r.yMax)){return}o[t.type](t.params,true)})}return{g:t,canvas:p,rescaleContent:r,clearContent:n,append:e,render:i}}();return true}else{return false}}function r(){var e=parseFloat(l.style("width"))/M.attr.width;var r=parseFloat(l.style("height"))/M.attr.height;l.style("width",M.attr.width+"px").style("height",M.attr.height+"px");h.forOwn(m,function(t){t.g.attr("width",M.attr.width+"px").attr("height",M.attr.height+"px");t.rescaleContent(e,r);t.render()});f(L.current())}function n(t){var e=M.utils.encode(t);if(m.hasOwnProperty(e)){m[e].canvas.clearRect(0,0,M.attr.width,M.attr.height);m[e].clearContent();return true}else{return false}}function a(){h.forOwn(m,function(t){t.canvas.save();t.canvas.clearRect(0,0,M.attr.width,M.attr.height)})}function o(t){var r=M.utils.encode(t);if(r&&m.hasOwnProperty(r)){h.forOwn(m,function(t,e){t.g.transition().duration(100).style("opacity",r===e?1:0)})}else{h.forOwn(m,function(t){t.g.transition().duration(100).style("opacity",1)})}return b}function i(e){h.forOwn(m,function(t){t.render(e)})}function s(){h.forOwn(m,function(t){t.canvas.restore()})}var c={dot:function(t,e,r,n){if(!e||e.length<2||typeof e[0]!=="number"||typeof e[1]!=="number")return false;var a=M.utils.encode(t);return m.hasOwnProperty(a)&&m[a].append("dot",{pos:j._project(e),size:r,color:n})},circle:function(t,e,r,n){if(!e||e.length<2||typeof e[0]!=="number"||typeof e[1]!=="number")return false;if(typeof r!=="number"||isNaN(r)||r<=0)return false;var a=M.utils.encode(t);return m.hasOwnProperty(a)&&m[a].append("circle",{pos:j._project(e),radius:r,color:n})},arrow:function(t,e,r,n,a){if(!e||e.length<2||typeof e[0]!=="number"||typeof e[1]!=="number")return false;if(!r||r.length<2||typeof r[0]!=="number"||typeof r[1]!=="number")return false;if(typeof n!=="number")return false;var o=M.utils.encode(t);if(m.hasOwnProperty(o)){var i=new P.LatLon(e).toVec(),s=new P.LatLon(r).toVec(),l=i.cross(s).cross(i).length(1),u=Math.acos(i.dot(s));var c=1,f=100,h=n*5,d=new P.Vector2(j._project(e)),p=new P.Vector2(j._project(r)),v=d,y=[v];do{var g=new P.Vector2(j._project(i.multiply(Math.cos((c+1)*u/f)).add(l.multiply(Math.sin((c+1)*u/f))).toLatLon().toArray()));c++;v=g;y.push(g)}while(c<f&&g.sub(p).length()>h);y.push(p);m[o].append("arrow",{segments:y,width:n,color:a});return true}else{return false}}};function f(e){v._clear();h.forOwn(m,function(t){t.canvas.translate(e.x,e.y);t.canvas.scale(e.k,e.k)});v._render(e.k);v._restore()}return{_style:r,_zoom:f,_clear:a,_restore:s,_render:i,get:t,add:e,highlight:o,erase:n,draw:c}}();this.staticLayer={get:v.get,add:v.add,erase:v.erase,highlight:v.highlight,draw:v.draw};var y=function(){var t=M.widget.append("div").attr("id",w+"-tiles-layer").style("position","absolute").style("pointer-events","none").style("z-index",99).style("mix-blend-mode","multiply").style("width",M.attr.width+"px").style("height",M.attr.height+"px");var r=null;function n(t){return j._invert([t[0]-.5*M.attr.width,t[1]+.5*M.attr.height])}function a(t){return Math.log(.00391382924*t*M.attr.width)/Math.log(2)}function e(){if(M.attr.tiles===null){return}if(!this.headerAdded){E.select("head").append("link").attr("rel","stylesheet").attr("href","https://unpkg.com/leaflet@1.3.1/dist/leaflet.css").attr("integrity","sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==").attr("crossorigin","");this.headerAdded=true}r=s.map(w+"-tiles-layer",{attributionControl:false,zoomSnap:0,zoomControl:false}).setView(n([0,0]),a(L.level()));var t=null,e=null;switch(M.attr.tiles){case"cartodb-positron":t="https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png";e="abcd";break}if(t&&e){s.tileLayer(t,{subdomains:e}).addTo(r)}o()}function o(){if(r===null){return}t.style("width",M.attr.width+"px").style("height",M.attr.height+"px");setTimeout(function(){r.invalidateSize();r.setView(n([0,0]),a(L.level()),{animate:false})},200)}function i(t){if(r===null){return}r.setView(n([-t.x/t.k-.5*(t.k-1)*M.attr.width/t.k,-t.y/t.k-.5*(t.k-1)*M.attr.height/t.k]),a(t.k),true)}return{_build:e,_style:o,_getLatLon:n,_getZoom:a,_zoom:i}}();var g=function(){var a=M.widget.append("div").attr("id",w+"-dynamic-layers").style("z-index",99).style("position","absolute").style("pointer-events","none");var O={};function t(){return Object.keys(O)}function e(t){var r=M.utils.encode(t);if(!O.hasOwnProperty(r)){O[r]=function(){var t=a.append("svg").attr("id",w+"-dynamic-layer-"+r).attr("width",M.attr.width+"px").attr("height",M.attr.height+"px").style("position","absolute").style("pointer-events","none").append("g");var n=[];function e(t){n.push({elem:t,birth:(new Date).getTime()/1e3})}setInterval(function(){var e=(new Date).getTime()/1e3;var r=[];n.forEach(function(t){if(e-t.birth>10){t.elem.transition().duration(700).style("opacity",0).on("end",function(){E.select(this).remove()})}else{r.push(t)}});n=r},2e3);return{g:t,append:e}}();return true}else{return false}}function r(){a.style("width",M.attr.width+"px").style("height",M.attr.height+"px");h.forOwn(O,function(t){t.g.attr("width",M.attr.width+"px").attr("height",M.attr.height+"px")})}function n(t){var e=M.utils.encode(t);if(O.hasOwnProperty(e)){O[e].g.html("");return true}else{return false}}function o(t){var r=M.utils.encode(t);if(r&&O.hasOwnProperty(r)){h.forOwn(O,function(t,e){t.g.transition().duration(200).style("opacity",r===e?1:0)})}else{h.forOwn(O,function(t){t.g.transition().duration(200).style("opacity",1)})}return b}var i={circle:function(t,e,r,n,a,o){if(!e||e.length<2||typeof e[0]!=="number"||typeof e[1]!=="number")return false;if(typeof r!=="number"||isNaN(r)||r<=0)return false;var i=M.utils.encode(t);if(O.hasOwnProperty(i)){var s=r/L.level();var l=j._project(e);var u=O[i].g.append("circle").attr("class","circle").attr("cx",l[0]).attr("cy",l[1]).attr("r",s).style("fill",n);O[i].append(u);u.transition().duration(a?a:700).ease(E.easeExp).attr("r",0).on("end",function(){o&&o();E.select(this).remove()});return true}else{return false}},arrow:function(t,e,r,n,a,o,i){if(!e||e.length<2||typeof e[0]!=="number"||typeof e[1]!=="number")return false;if(!r||r.length<2||typeof r[0]!=="number"||typeof r[1]!=="number")return false;if(typeof n!=="number")return false;var s=M.utils.encode(t);if(O.hasOwnProperty(s)){var l=100;var u=null;var c=null;var f=new P.Vector2(j._project(e));var h=new P.Vector2(j._project(r));var d=n/L.level();var p=d*2;var v=d*5;u=O[s].g.append("path").style("fill","none").style("stroke",a).style("stroke-width",d).attr("d","M"+f.x()+","+f.y());c=O[s].g.append("path").style("fill",a).style("stroke","none");var y=new P.LatLon(e).toVec();var g=new P.LatLon(r).toVec();var m=y.cross(g).cross(y).length(1);var w=Math.acos(y.dot(g));var b=1;var x=f;var _=(typeof o==="number"?o:700)/l;var k=setInterval(function(){var t=new P.Vector2(j._project(y.multiply(Math.cos((b+1)*w/l)).add(m.multiply(Math.sin((b+1)*w/l))).toLatLon().toArray()));u.attr("d",u.attr("d")+(t.sub(x).length()<.5*M.attr.width?"L":"M")+t.x()+","+t.y());if(t.sub(x).length()<.5*M.attr.width){var e=t.sub(x).length(1);var r=e.angle(e.angle()+Math.PI/2).multiply(p);var n=t.sub(r);var a=t.add(r);var o=t.add(e.multiply(v));c.attr("d","M"+n.x()+","+n.y()+"L"+a.x()+","+a.y()+"L"+o.x()+","+o.y()+"Z")}if(t.sub(h).length()>v){b++;x=t}else{clearInterval(k);e=h.sub(t).length(1);r=e.angle(e.angle()+Math.PI/2).multiply(p);n=h.sub(e.multiply(v)).sub(r);a=h.sub(e.multiply(v)).add(r);c.transition().duration(_).attr("d","M"+n.x()+","+n.y()+"L"+a.x()+","+a.y()+"L"+h.x()+","+h.y()+"Z").on("end",function(){i&&i();u.transition().duration(1e3).style("opacity",0).on("end",function(){E.select(this).remove()});E.select(this).transition().duration(1e3).style("opacity",0).on("end",function(){E.select(this).remove()})})}},_);return true}else{return false}}};function s(e){h.forOwn(O,function(t){t.g.attr("transform",e)})}return{_style:r,_zoom:s,get:t,add:e,highlight:o,erase:n,draw:i}}();this.dynamicLayer={get:g.get,add:g.add,highlight:g.highlight,erase:g.erase,draw:g.draw};var x=function(){var t=M.widget.append("svg").attr("id",w+"-touch-layer").attr("width",M.attr.width+"px").attr("height",M.attr.height+"px").style("position","absolute").style("pointer-events","none");var l=t.append("g");function e(t,e,r,n,a,o){if(!e||e.length<2||typeof e[0]!=="number"||typeof e[1]!=="number")return false;var i=r/L.level();var s=j._project(e);l.append("circle").attr("id",w+"-touch-layer-"+t).attr("cx",s[0]).attr("cy",s[1]).attr("r",i).style("fill",null).style("opacity",0).style("pointer-events","all").on("mouseover",function(t,e){if(n)n(t,e)}).on("mouseleave",function(t,e){if(a)a(t,e)}).on("click",function(t,e){if(o)o(t,e)});return true}function r(t){var e=l.select("#"+t);if(e.empty())return false;else{e.remove();return true}}function n(){t.style("width",M.attr.width+"px").style("height",M.attr.height+"px");l.style("width",M.attr.width+"px").style("height",M.attr.height+"px")}function a(t){l.attr("transform",t)}function o(){l.html("")}return{_style:n,_zoom:a,add:e,remove:r,erase:o}}();this.touchLayer={add:x.add,remove:x.remove,erase:x.erase};M.render.build=function(){m._build(function(){j._build();y._build();M.attr.ready&&M.attr.ready()})};M.render.update=function(){j._update()};M.render.style=function(){M.widget.style("background-color",M.attr.backgroundColor).style("pointer-events",null);L.init();j._style();y._style();v._style();g._style();x._style();r._mark()}}t.prototype=Object.create(n.prototype);return t});