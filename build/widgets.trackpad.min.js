(function(t,r){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=r(require("d3"),require("./widget"),exports)}else if(typeof define==="function"&&define.amd){define(["d3","src/widget","exports"],r)}else{t.du=t.du||{};t.du.widgets=t.du.widgets||{};t.du.widgets.TrackPad=r(t.d3,t.du.Widget)}})(this,function(n,s){"use strict";function t(t,r){var a=s.call(this,t,"slider","svg",r);a.attr.add(this,"xRange",[0,1]);a.attr.add(this,"yRange",[0,1]);a.attr.add(this,"callback",null);a.attr.add(this,"guide",false);var e={};var i=null;a.render.build=function(){i={x:n.scaleLinear().domain(a.attr.xRange).range([0,a.attr.width-a.attr.margins.left-a.attr.margins.right]).clamp(true),y:n.scaleLinear().domain(a.attr.yRange).range([0,a.attr.height-a.attr.margins.top-a.attr.margins.bottom]).clamp(true)};e.g=a.widget.append("g").attr("transform","translate("+a.attr.margins.left+",20)");e.track=e.g.append("rect").attr("rx","3").attr("ry","3").attr("x",i.x.range()[0]).attr("y",i.y.range()[0]).attr("width",a.attr.width-a.attr.margins.left-a.attr.margins.right+"px").attr("height",a.attr.height-a.attr.margins.top-a.attr.margins.bottom+"px");e.inset=e.track.select(function(){return this.parentNode.appendChild(this.cloneNode(true))}).style("fill","white").style("opacity",.9).attr("rx","2.5").attr("ry","2.5").attr("x",i.x.range()[0]+.5).attr("y",i.y.range()[0]+.5).attr("width",a.attr.width-a.attr.margins.left-a.attr.margins.right-1+"px").attr("height",a.attr.height-a.attr.margins.top-a.attr.margins.bottom-1+"px");if(a.attr.guide){e.guide={h:e.g.append("line").attr("x1",i.x.range()[0]).attr("y1",i.y.range()[0]).attr("x2",i.x.range()[1]).attr("y2",i.y.range()[0]).attr("stroke-dasharray","3, 6").style("stroke",a.attr.fontColor).style("stroke-width","1px"),v:e.g.append("line").attr("x1",i.x.range()[0]).attr("y1",i.y.range()[0]).attr("x2",i.x.range()[0]).attr("y2",i.y.range()[1]).attr("stroke-dasharray","3, 6").style("stroke-width","1px")}}e.overlay=e.inset.select(function(){return this.parentNode.appendChild(this.cloneNode(true))}).attr("class","track-overlay").style("pointer-events","all").style("cursor","pointer").style("fill","transparent").call(n.drag().on("start drag",function(){var t=i.x.invert(n.event.x),r=i.y.invert(n.event.y);e.handle.attr("cx",i.x(t)).attr("cy",i.y(r));if(e.guide){e.guide.h.attr("x1",i.x.range()[0]).attr("y1",i.y(r)).attr("x2",i.x.range()[1]).attr("y2",i.y(r));e.guide.v.attr("x1",i.x(t)).attr("y1",i.y.range()[0]).attr("x2",i.x(t)).attr("y2",i.y.range()[1])}a.attr.callback&&a.attr.callback(t,r)}));e.axis={x:e.g.append("g").attr("class","x axis").style("font-family","inherit").style("fill","none"),y:e.g.append("g").attr("class","x axis").style("font-family","inherit").style("fill","none")};e.handle=e.g.insert("circle",".track-overlay").style("fill","white").style("stroke-width","0.5px").attr("r",7)};a.render.style=function(){a.widget.style("width",a.attr.width+"px");a.widget.style("height",a.attr.height+"px");i.x.range([0,a.attr.width-a.attr.margins.left-a.attr.margins.right]);i.y.range([0,a.attr.height-a.attr.margins.top-a.attr.margins.bottom]);e.track.style("fill",a.attr.fontColor).attr("x",i.x.range()[0]).attr("y",i.y.range()[0]).attr("width",a.attr.width-a.attr.margins.left-a.attr.margins.right+"px").attr("height",a.attr.height-a.attr.margins.top-a.attr.margins.bottom+"px");e.inset.attr("x",i.x.range()[0]+.5).attr("y",i.y.range()[0]+.5).attr("width",a.attr.width-a.attr.margins.left-a.attr.margins.right-1+"px").attr("height",a.attr.height-a.attr.margins.top-a.attr.margins.bottom-1+"px");if(a.attr.guide){e.guide.h.style("stroke",a.attr.fontColor);e.guide.v.style("stroke",a.attr.fontColor)}e.overlay.attr("x",i.x.range()[0]-a.attr.margins.left+10).attr("y",i.y.range()[0]-a.attr.margins.top+10).attr("width",a.attr.width-20+"px").attr("height",a.attr.height-20+"px");e.axis.x.attr("transform","translate(-1,"+(a.attr.height-a.attr.margins.bottom-30)+")").call(n.axisBottom().ticks(5).scale(i.x));e.axis.y.call(n.axisLeft().ticks(5).scale(i.y));e.g.selectAll("path").style("fill","none").style("stroke","none");e.g.selectAll(".tick > line").style("fill","none").style("stroke","none");e.g.selectAll("text").attr("font-size",a.attr.fontSize+"px").attr("fill",a.attr.fontColor);e.handle.style("stroke",a.attr.fontColor)}}t.prototype=Object.create(s.prototype);return t});